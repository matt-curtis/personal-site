import type { PropsWithChildren } from 'react';
import Details from '../details';
import styles from './style.module.css';
import { useDetailsAnimator } from '../useDetailsAnimator';

export default function TLDR(props: PropsWithChildren) {
    const animator = useDetailsAnimator();

    return (
        <Details
            detailProps={{
                ref: animator.detailsRef,
                className: styles['tldr']
            }}
            summaryProps={{
                'aria-label': 'TLDR',
                className: styles['header'],
                children: (<>
                    <div className={styles['header__label']}>
                        <LabelText />
                        <LabelPunctuation />
                    </div>

                    <StateIndicator />
                </>)
            }}
            contentContainerProps={{
                ref: animator.contentRef,
                className: styles['content'],
                children: props.children
            }}
        />
    )
};

function LabelText() {
    const remSize = {
        width: (103 / 16) + 'rem',
        height: (27 / 16) + 'rem'
    };

    return (
        <svg {...remSize}>
            <path fill="var(--tldr-color)" d="m10.1 7 .7.5.1.3v1q0 .3-.2.6-.5 7-.3 14.2l.4-.5.2 1.1-.1 1.8-.2.4-.3.4h-.5l-.8-.2-.2-.3-.1-.3q-.2-.6-.2-1V25q-.5-8.3.3-16.7v-.3l.2-.3q0-.1.3-.3l.2-.2zm-.7 18.3v.1zm13-25a1 1 0 0 1 .8 1.8l-1.1.5-4.5 1.7C12.4 6 7.7 8.4 1.3 8L1.1 8l-.5-.5q-.7-1-.6-1.7a1 1 0 0 1 2 0v.4c4.4.2 10-2 15-3.7L21.3.8z"/>
            <path fill="var(--tldr-color)" d="M28.4 2a1 1 0 1 0-2 0V4q-.4 10.4.2 20.8v.7l.7.2Q35 27 42.5 24.6a9 9 0 0 0 3-2l1.5-1.8-2.1.8-3 1.2a29 29 0 0 1-14.2 1l.8 1q-.6-10.2-.2-20.6z"/>
            <path fill="var(--tldr-color)" d="M60.4.4a6 6 0 0 1 4.3 2 21 21 0 0 1 4 8.7 12 12 0 0 1-1.4 9.5c-1.7 2.2-4 3-6.1 3.8l-.2.1a12 12 0 0 1-4.6 0h-.3l-.1-.2q-.7-.5-1-1.2 0 .2-.5.5c-.2.2-1 .7-1.7.2q-.7-.6-.7-1l-.2-.9v-2.7q0-2.7.4-5.3l1-6.5V2l.2-.5a1 1 0 0 1 1.8.5l.3-.2Q57 1 58.8.6zm0 2h-1.1q-1.6.4-2.7 1l-.7.7-.7 4.3v.2q.1 5.7.3 11.5l.8.2q.3.2.3.6l.3 1.7 1.1.2 2.4-.1h.2c2-.9 4-1.7 5.1-3.2l.2-.3q2-3.6 1-7.6l-.2-.8a19 19 0 0 0-3.4-7.1l-.7-.7q-1-.6-2.2-.7"/>
            <path fill="var(--tldr-color)" d="M80.3 4.9a1 1 0 0 0-1.7.7V6l.2 1.6.3 7.4v.2c0 2.5.3 5.2 0 7.4v.3l.2-.4.5-.3h.4L80 22c-2-4.7-.7-10.8.9-16v-.3c.7-1.6 3.5-2.6 5.9-3h.3c.6-.2 1.6.9 2.3 2l.2.3q.7 1.1.9 2.8v.4q0 1.5-1.6 2.8l-.3.3a9 9 0 0 1-6.3 2l-.7.2-.4.3q-.3.2-.5.7l.1.9q0 .3.3.4.4.5 1 .8l1.8 1 3.7 1.7 7.5 3 1.8.6c1 .3 2 .8 3.4.5h.2l1.4-1a1 1 0 0 0-1.4-1.4q-.5.5-.8.6h.2q-.9 0-2.4-.5l-1.6-.6h-.1l-11-4.6-2.3-1.4v.4l-.1.4q-.2 0 0 0a11 11 0 0 0 7.8-2.9c1-1 2.4-2.3 2.2-4.4v-.4q-.1-1.9-1.2-3.7l-.2-.3-1.5-1.8q-.9-1.1-2.7-1h-.4c-2.6.6-5.7 1-7.3 4.3v.3c-1.6 5.5-3.3 11.5-.8 17.5l.2.3.6.6.4.2h.7a1 1 0 0 0 .8-.8v-.3c.4-2.8 0-5.2 0-7.8l-.2-5.4c-.1-1.6 0-2.7-.5-4.7" />
        </svg>
    );
};

function LabelPunctuation() {
    const remSize = {
        width: (13 / 16) + 'rem',
        height: (25 / 16) + 'rem'
    };

    return (
        <>
            <svg {...remSize} className={styles['header__label-qm']}>
                <path fill="var(--tldr-color)" d="M5.57 21.88a.96.96 0 1 1 .86 1.71l-.1.05-1.8.9-.1.05a.96.96 0 1 1-.86-1.7l.1-.06 1.8-.9zM10.7.11c.17-.06.43-.1.7-.03s.47.23.59.36c.23.27.27.46.33.62a3 3 0 0 1 .1 1.3c-1.03 6.07-5.5 10.08-8.6 14.23.3-.23.7-.38.95-.43.4-.07.56-.1.65-.15a1 1 0 0 0 .3-.3.96.96 0 1 1 1.59 1.05c-.22.34-.56.72-1.02.95-.45.24-.91.28-1.11.32-.2.05-.15.05-.2.08q-.31.38-.78.72-.24.17-.61.32c-.25.1-.65.19-1.12 0-.8-.4-.9-1.04-.95-1.45q-.04-.6.11-1.08c.15-.46.3-.66.46-.91 3.4-4.5 7.56-8.47 8.4-13.45a28 28 0 0 0-7.2 4.81 9 9 0 0 0-.8.9.96.96 0 0 1-1.9-.14c.05-.67.23-.75.34-.96q.18-.27.35-.46.35-.4.7-.73A29 29 0 0 1 10.7.11"/>
            </svg>

            <svg {...remSize} className={styles['header__label-period']}>
                <path fill="var(--tldr-color)" d="M6.39 23.55a.96.96 0 0 0-.86-1.71l-.1.05-1.8.9-.1.05a.96.96 0 1 0 .86 1.7q.04 0 .1-.04l1.8-.9z"/>
            </svg>
        </>
    );
};

function StateIndicator() {
    const remSize = {
        width: (27 / 16) + 'rem',
        height: (25 / 16) + 'rem'
    };

    return (
        <>
            <svg {...remSize} className={styles['header__collapsed-icon']}>
                <path fill="var(--tldr-color)" d="M.98 13.34a.96.96 0 0 0 .86-1.7l-.19-.1s0-.03.15.14q.05.07.12.25a1 1 0 0 1 0 .49c-.1.34-.26.43-.32.47-.22.13-.1.05-.06.06l.23-.04a16 16 0 0 1 1.42-.11c4.05-.16 8.18-.13 12.3-.26h.06c2.8-.08 5.62-.33 8.38-.55l1.22-.1a.96.96 0 1 0-.14-1.9l-1.23.09c-2.8.23-5.53.47-8.3.55h-.05c-4.08.13-8.17.1-12.33.25a31 31 0 0 0-1.59.13l-.38.07c-.15.04-.24 0-.63.25-.1.08-.3.2-.42.6a1 1 0 0 0 .17.87c.2.26.29.29.37.35z"/>
                <path fill="var(--tldr-color)" d="M15.08 1.68A.96.96 0 0 0 13.73.32a2 2 0 0 0-.52.85q-.12.38-.16.68c-.17 1.07-.2 2.03-.24 3.02v.01a60 60 0 0 0 2.21 18.51.96.96 0 0 0 1.84-.51q-.16-.54-.28-1.07a58 58 0 0 1-1.86-16.86c.04-.96.08-1.93.22-2.78q.03-.25.09-.4.02-.09.03-.08z"/>
            </svg>

            <svg {...remSize} className={styles['header__expanded-icon']}>
                <path fill="var(--tldr-color)" d="M.98 13.34a.96.96 0 0 0 .86-1.7l-.19-.1s0-.03.15.14q.05.07.12.25a1 1 0 0 1 0 .49c-.1.34-.26.43-.32.47-.22.13-.1.05-.06.06l.23-.04a16 16 0 0 1 1.42-.11c4.05-.16 8.18-.13 12.3-.26h.06c2.8-.08 5.62-.33 8.38-.55l1.22-.1a.96.96 0 1 0-.14-1.9l-1.23.09c-2.8.23-5.53.47-8.3.55h-.05c-4.08.13-8.17.1-12.33.25a31 31 0 0 0-1.59.13l-.38.07c-.15.04-.24 0-.63.25-.1.08-.3.2-.42.6a1 1 0 0 0 .17.87c.2.26.29.29.37.35z"/>
            </svg>
        </>
    );
};